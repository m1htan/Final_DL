3D-CODED : 3D Correspondences by Deep
Deformation
Thibault Groueix1, Matthew Fisher2, Vladimir G. Kim2, Bryan C. Russell2,
and Mathieu Aubry1
1 LIGM (UMR 8049), ´Ecole des Ponts, UPE
2 Adobe Research
http://imagine.enpc.fr/~groueixt/3D-CODED/
Abstract. We present a new deep learning approach for matching de-
formable shapes by introducing Shape Deformation Networks which jointly
encode 3D shapes and correspondences. This is achieved by factoring
the surface representation into (i) a template, that parameterizes the
surface, and (ii) a learnt global feature vector that parameterizes the
transformation of the template into the input surface. By predicting this
feature for a new shape, we implicitly predict correspondences between
this shape and the template. We show that these correspondences can
be improved by an additional step which improves the shape feature by
minimizing the Chamfer distance between the input and transformed
template. We demonstrate that our simple approach improves on state-
of-the-art results on the diﬃcult FAUST-inter challenge, with an average
correspondence error of 2.88cm. We show, on the TOSCA dataset, that
our method is robust to many types of perturbations, and generalizes
to non-human shapes. This robustness allows it to perform well on real
unclean, meshes from the the SCAPE dataset.
Keywords: 3D deep learning, computational geometry, shape matching
(a) Input Shape
(b) Template
(c) Deformed template
Fig. 1: Our approach predicts shape correspondences by learning a consistent
mesh parameterization with a shared template. Colors show correspondences.
2
T. Groueix, M. Fisher, V. G. Kim, B. C. Russell, M. Aubry
1
Introduction
There is a growing demand for techniques that make use of the large amount
of 3D content generated by modern sensor technology. An essential task is to
establish reliable 3D shape correspondences between scans from raw sensor data
or between scans and a template 3D shape. This process is challenging due to
low sensor resolution and high sensor noise, especially for articulated shapes,
such as humans or animals, that exhibit signiﬁcant non-rigid deformations and
shape variations.
Traditional approaches to estimating shape correspondences for articulated
objects typically rely on intrinsic surface analysis either optimizing for an isomet-
ric map or leveraging intrinsic point descriptors [40]. To improve correspondence
quality, these methods have been extended to take advantage of category-speciﬁc
data priors [9]. Eﬀective human-speciﬁc templates and registration techniques
have been developed over the last decade [46], but these methods require signif-
icant eﬀort and domain-speciﬁc knowledge to design the parametric deformable
template, create an objective function that ensures alignment of salient regions
and is not prone to being stuck in local minima, and develop an optimization
strategy that eﬀectively combines a global search for a good heuristic initializa-
tion and a local reﬁnement procedure.
In this work, we propose Shape Deformation Networks, a comprehensive,
all-in-one solution to template-driven shape matching. A Shape Deformation
Network learns to deform a template shape to align with an input observed
shape. Given two input shapes, we align the template to both inputs and obtain
the ﬁnal map between the inputs by reading oﬀthe correspondences from the
template.
We train our Shape Deformation Network as part of an encoder-decoder
architecture, which jointly learns an encoder network that takes a target shape
as input and generates a global feature representation, and a decoder Shape
Deformation Network that takes as input the global feature and deform the
template into the target shape. At test time, we improve our template-input
shape alignment by optimizing locally the Chamfer distance between target and
generated shape over the global feature representation which is passed in as
input to the Shape Deformation Network. Critical to the success of our Shape
Deformation Network is the ability to learn to deform a template shape to targets
with varied appearances and articulation. We achieve this ability by training our
network on a very large corpus of shapes.
In contrast to previous work [46], our method does not require a manually
designed deformable template; the deformation parameters and degrees of free-
dom are implicitly learned by the encoder. Furthermore, while our network can
take advantage of known correspondences between the template and the example
shapes, which are typically available when they have been generated using some
parametric model [6,42], we show it can also be trained without correspondence
supervision. This ability allows the network to learn from a large collection of
shapes lacking explicit correspondences.
3D-CODED : 3D Correspondences by Deep Deformation
3
We demonstrate that with suﬃcient training data this simple approach achieves
state-of-the-art results and outperforms techniques that require complex multi-
term objective functions instead of the simple reconstruction loss used by our
method.
2
Related work
Registration of non-rigid geometries with pose and shape variations is a long
standing problem with extensive prior work. We ﬁrst provide a brief overview of
generic correspondence techniques. We then focus on category speciﬁc and tem-
plate matching methods developed for human bodies, which are more closely
related to our approach. Finally, we present an overview of deep learning ap-
proaches that have been developed for shape matching and more generally for
working with 3D data.
Generic shape matching. To estimate correspondence between articulated
objects, it is common to assume that their intrinsic structure (e.g., geodesic dis-
tances) remains relatively consistent across all poses [28]. Finding point-to-point
correspondences that minimize metric distortion is a non-convex optimization
problem, referred to as generalized multi-dimensional scaling [11]. This optimiza-
tion is typically sensitive to an initial guess [10], and thus existing techniques
rely on local feature point descriptors such as HKS [40] and WKS [5], and use hi-
erarchical optimization strategies [35,14]. Some relaxations of this problem have
been proposed such as: formulating it as Markov random ﬁeld and using linear
programming relaxation [13], optimizing for soft correspondence [38,20,39], re-
stricting correspondence space to conformal maps [22,21], heat kernel maps [30],
and aligning functional bases [31].
While these techniques are powerful generic tools, some common categories,
such as humans, can beneﬁt from a plethora of existing data [6] to leverage
stronger class-speciﬁc priors.
Template-based shape matching. A natural way to leverage class-speciﬁc
knowledge is through the explicit use of a shape model. While such template-
based techniques provide the best correspondence results they require a careful
parameterization of the template, which took more than a decade of research to
reach the current level of maturity [1,2,3,24,46]. For all of these techniques, ﬁtting
this representation to an input 3D shape requires also designing an objective
function that is typically non-convex and involves multiple terms to guide the
optimization to the right global minima. In contrast, our method only relies on
a single template 3D mesh and surface reconstruction loss. It leverages a neural
network to learn how to parameterize the human body while optimizing for the
best reconstruction.
4
T. Groueix, M. Fisher, V. G. Kim, B. C. Russell, M. Aubry
Deep learning for shape matching. Another way to leverage priors and
training data is to learn better point-wise shape descriptors using human mod-
els with ground truth correspondence. Several neural network based methods
have recently been developed to this end to analyze meshes [34,26,7,29] or depth
maps [43]. One can further improve these results by leveraging global context, for
example, by estimating an inter-surface functional map [23]. These methods still
rely on hand-crafted point-wise descriptors [41] as input and use neural networks
to improve results. The resulting functional maps only align basis functions and
additional optimization is required to extract consistent point-to-point corre-
spondences [31]. One would also need to optimize for template deformation to
use these matching techniques for surface reconstruction. In contrast our method
does not rely on hand-crafted features (it only takes point coordinates as input)
and implicitly learns a human body representation. It also directly outputs a
template deformation.
Deep Learning for 3D data. Following the success of deep learning ap-
proaches for image analysis, many techniques have been developed for processing
3D data, going beyond local descriptor learning to improve classiﬁcation, seg-
mentation, and reconstruction tasks. Existing networks operate on various shape
representations, such as volumetric grids [17,44], point clouds [32,33,16], geome-
try images [37,36], seamlessly parameterized surfaces [25], by aligning a shape to
a grid via distance-preserving maps [15], by folding a surface [45] or by predict-
ing chart representations [18]. We build on these works in several ways. First, we
process the point clouds representing the input shapes using an architecture sim-
ilar to [32]. Second, similar to [36], we learn a surface representation. However,
we do not explicitly encode correspondences in the output of a convolution net-
work, but implicitly learn them by optimizing for parameters of the generation
network as we optimize for reconstruction losss.
3
Method
Our goal is, given a reference shape Sr and a target shape St, to return a set
of point correspondences C between the shapes. We do so using two key ideas.
First, we learn to predict a transformation between the shapes instead of directly
learning the correspondences. This transformation, from 3D to 3D can indeed
be represented by a neural network more easily than the association between
variable and large number of points. The second idea is to learn transformations
only from one template A to any shape. Indeed, the large variety of possible
poses of humans makes considering all pairs of possible poses intractable during
training. We instead decouple the correspondence problem into ﬁnding two sets
of correspondences to a common template shape. We can then form our ﬁnal
correspondences between the input shapes via indexing through the template
shape. An added beneﬁt is during training we simply need to vary the pose for
a single shape and use the known correspondences to the template shape as the
supervisory signal.
3D-CODED : 3D Correspondences by Deep Deformation
5
(a) Network training
(b) Local optimization of feature x
(c) Correspondences
Fig. 2: Method overview. (a) A feed-forward pass in our autoencoder encodes
input point cloud S to latent code E (S) and reconstruct S using E (S) to deform
the template A. (b) We reﬁne the reconstruction D (A, E (S)) by performing
a regression step over the latent variable x, minimizing the Chamfer distance
between D (A, x) and S. (c) Finally, given two point clouds Sr and St, to match
a point qr on Sr to a point qt on St, we look for the nearest neighbor pr of
qr in D (A, xr), which is by design in correspondence with pt; and look for the
nearest neighbor qt of pt on St. Red indicates what is being optimised.
Our approach has three main steps which are visualized ﬁgure 2. First, a
feed-forward pass through our encoder network generates an initial global shape
descriptor (Section 3.1). Second, we use gradient descent through our decoder
Shape Deformation Network to reﬁne this shape descriptor to improve the re-
construction quality (Section 3.2). We can then use the template to match points
between any two input shapes (Section 3.3).
3.1
Learning 3D shape reconstruction by template deformation
To put an input shape S in correspondence with a template A, our ﬁrst goal is
to design a neural network that will take S as input and predict transformation
6
T. Groueix, M. Fisher, V. G. Kim, B. C. Russell, M. Aubry
parameters. We do so by training an encoder-decoder architecture. The encoder
Eφ deﬁned by its parameters φ takes as input 3D points, and is a simpliﬁed
version of the network presented in [32]. It applies to each input 3D point co-
ordinate a multi-layer perceptron with hidden feature size of 64, 128 and 1024,
then maxpooling over the resulting features over all points followed by a linear
layer, leading to feature of size 1024 Eφ (S). This feature, together with the 3D
coordinates of a point on the template p ∈A, are taken as input to the de-
coder Dθ with parameters θ, which is trained to predict the position q of the
corresponding point in the input shape. This decoder Shape Deformation Net-
work is a multi-layer perceptron with hidden layers of size 1024, 512, 254 and
128, followed by a hyperbolic tangent. This architecture maps any points from
the template domain to the reconstructed surface. By sampling the template
more or less densely, we can generate an arbitrary number of output points by
sequentially applying the decoder over sampled template points.
This encoder-decoder architecture is trained end-to-end. We assume that we
are given as input a training set of N shapes

S(i)	N
i=1 with each shape hav-
ing a set of P vertices {qj}P
j=1. We consider two training scenarios: one where
the correspondences between the template and the training shapes are known
(supervised case) and one where they are unknown (unsupervised case). Super-
vision is typically available if the training shapes are generated by deforming
a parametrized template, but real object scans are typically obtained without
correspondences.
Supervised loss. In the supervised case, we assume that for each point qj on
a training shape we know the correspondence pj ↔qj to a point pj ∈A on the
template A. Given these training correspondences, we learn the encoder Eφ and
decoder Dθ by simply optimizing the following reconstruction losses,
Lsup(θ, φ) =
N
X
i=1
P
X
j=1
|Dθ

pj; Eφ

S(i)
−q(i)
j |2
(1)
where the sums are over all P vertices of all N example shapes.
Unsupervised loss. In the case where correspondences between the exemplar
shapes and the template are not available, we also optimize the reconstructions,
but also regularize the deformations toward isometries. For reconstruction, we
use the Chamfer distance LCD between the inputs Si and reconstructed point
clouds Dθ
 A; Eφ
 S(i)
. For regularization, we use two diﬀerent terms. The ﬁrst
term LLap encourages the Laplacian operator deﬁned on the template and the
deformed template to be the same (which is the case for isometric deformations of
the surface). The second term Ledges encourages the ratio between edges length
in the template and its deformed version to be close to 1. More details on these
diﬀerent losses are given in supplementary material. The ﬁnal loss we optimize
is:
Lunsup = LCD + λLapLLap + λedgesLedges
(2)
3D-CODED : 3D Correspondences by Deep Deformation
7
where λLap and λedges control the inﬂuence of regularizations against the data
term LCD. They are both set to 5.10−3 in our experiments.
We optimize the loss using the Adam solver, with a learning rate of 10−3
for 25 epochs then 10−4 for 2 epochs, batches of 32 shapes, and 6890 points per
shape.
One interesting aspect of our approach is that it learns jointly a parameteri-
zation of the input shapes via the decoder and to perdict the parameters Eφ (S)
for this parameterization via the encoder. However, the predicted parameters
Eφ (S) for an input shape S are not necessarily optimal, because of the limited
power of the encoder. Optimizing these parameters turns out to be important
for the ﬁnal results, and is the focus of the second step of our pipeline.
3.2
Optimizing shape reconstruction
We now assume that we are given a shape S as well as learned weights for
the encoder Eφ and decoder Dθ networks. To ﬁnd correspondences between the
template shape and the input shape, we will use a nearest neighbor search to ﬁnd
correspondences between that input shape and its reconstruction. For this step
to work, we need the reconstruction to be accurate. The reconstruction given
by the parameters Eφ (S) is only approximate and can be improved. Since we
do not know correspondences between the input and the generated shape, we
cannot minimize the loss given in equation (1), which requires correspondences.
Instead, we minimize with respect to the global feature x the Chamfer distance
between the reconstructed shape and the input:
LCD(x; S) =
X
p∈A
min
q∈S |Dθ (p; x) −q|2 +
X
q∈S
min
p∈A |Dθ (p; x) −q|2 .
(3)
Starting from the parameters predicted by our ﬁrst step x = Eφ (S), we
optimize this loss using the Adam solver for 3,000 iterations with learning rate
5 ∗10−4. Note that the good initialization given by our ﬁrst step is key since
Equation( 3) corresponds to a highly non-convex problem, as shown in Figure 6.
3.3
Finding 3D shape correspondences
To recover correspondences between two 3D shapes Sr and St, we ﬁrst compute
the parameters to deform the template to these shapes, xr and xt, using the
two steps outlined in section 3.1 and 3.2. Next, given a 3D point qr on the
reference shape Sr, we ﬁrst ﬁnd the point p on the template A such that its
transformation with parameters xr, Dθ (p; xr) is closest to qr. Finally we ﬁnd
the 3D point qt on the target shape St that is the closest to the transformation
of p with parameters xt, Dθ (p; xt). Our algorithm is summarized in Algorithm 1
and illustrated in Figure 2.
8
T. Groueix, M. Fisher, V. G. Kim, B. C. Russell, M. Aubry
Algorithm 1: Algorithm for ﬁnding 3D shape correspondences
Input
: Reference shape Sr and target shape St
Output: Set of 3D point correspondences C
1 #Regression steps over latent code to ﬁnd best reconstruction of Sr and St
2 xr ←arg minx LCD (x; Sr) #detailed in equation (3)
3 xt ←arg minx LCD (x; St) #detailed in equation (3)
4 C ←∅
5 # Matching of qr ∈Sr to qt ∈St
6 foreach qr ∈Sr do
7
p ←arg minp′∈A |Dθ (p′; xr) −qr|2
8
qt ←arg minq′∈St |Dθ (p; xt) −q′|2
9
C ←C ∪{(qr, qt)}
10 end
11 return C
(a) SURREAL [42]
(b) Bent shapes
(c) FAUST [6]
Fig. 3: Examples of the diﬀerent datasets used in the paper.
4
Results
4.1
Datasets
Synthetic training data. To train our algorithm, we require a large set of
shapes. We thus rely on synthetic data for training our model.
For human shapes, we use SMPL [6], a state-of-the-art generative model
for synthetic humans. To obtain realistic human body shape and poses from
the SMPL model, we sampled 2.105 parameters estimated in the SURREAL
dataset [42]. One limitation of the SURREAL dataset is it does not include any
humans bent over. Without adapted training data, our algorithm generalized
poorly to these poses. To overcome this limitation, we generated an extension of
the dataset. We ﬁrst manually estimated 7 key-joint parameters (among 23 joints
in the SMPL skeletons) to generate bent humans. We then sampled randomly
the 7 parameters around these values, and used parameters from the SURREAL
dataset for the other pose and body shape parameters. Note that not all meshes
generated with this strategy are realistic as shown in ﬁgure 3. They however
allow us to better cover the space of possible poses, and we added 3 · 104 shapes
generated with this method to our dataset. Our ﬁnal dataset thus has 2.3 · 105
human meshes with a large variety of realistic poses and body shapes.
For animal shapes, we use the SMAL [48] model, which provides the equiva-
lent of SMPL for several animals. Recent papers estimate model parameters from
3D-CODED : 3D Correspondences by Deep Deformation
9
images, but no large-scale parameter set is yet available. For training we thus
generated models from SMAL with random parameters (drawn from a Gaussian
distribution of ad-hoc variance 0.2). This approach works for the 5 categories
available in SMAL. In SMALR [47], Zuﬃet al. showed that the SMAL model
could be generalized to other animals using only an image dataset as input,
demonstrating it on 17 additional categories. Note that since the templates for
two animals are in correspondences, our method can be used to get inter-category
correspondences for animals. We qualitatively demonstrate this on hippopota-
mus/horses in the appendix [19].
Testing data. We evaluate our algorithm on the FAUST [6], TOSCA [12] and
SCAPE [4] datasets.
The FAUST dataset consists of 100 training and 200 testing scans of ap-
proximately 170,000 vertices. They may include noise and have holes, typically
missing part of the feet. In this paper, we never used the training set, except for
a single baseline experiment, and we focus on the test set. Two challenges are
available, focusing on intra- and inter-subject correspondences. The error is the
average Euclidean distance between the estimated projection and the ground-
truth projection. We evaluated our method through the online server and are
the best public results on the ’inter’ challenge at the time of submission3.
The SCAPE [4] dataset has two sets of 71 meshes : the ﬁrst set consists of
real scans with holes and occlusions and the second set are registered meshes
aligned to the ﬁrst set. The poses are diﬀerent from both our training dataset
and FAUST.
TOSCA is a dataset produced by deforming 3 template meshes (human, dog,
and horse). Each mesh is deformed into multiple poses, and might have various
additional perturbations such as random holes in the surface, local and global
scale variations, noise in vertex positions, varying sampling density, and changes
in topology.
Shape normalization. To be processed and reconstructed by our network,
the training and testing shapes must be normalized in a similar way. Since the
vertical direction is usually known, we used synthetic shapes with approximately
the same vertical axis. We also kept a ﬁxed orientation around this vertical axis,
and at test time selected the one out of 50 diﬀerent orientations which leads to the
smaller reconstruction error in term of Chamfer distance. Finally, we centered all
meshes according to the center of their bounding box and, for the training data
only, added a random translation in each direction sampled uniformly between
-3cm and 3cm to increase robustness.
4.2
Experiments
In this part, we analyze the key components of our pipeline. More results are
available in the appendix [19].
3 http://faust.is.tue.mpg.de/challenge/Inter-subject_challenge
10
T. Groueix, M. Fisher, V. G. Kim, B. C. Russell, M. Aubry
Results on FAUST. The method presented above leads to the best results to
date on the FAUST-inter dataset: 2.878 cm : an improvement of 8% over
state of the art, 3.12cm for [46] and 4.82cm for [23]. Although it cannot take
advantage of the fact that two meshes represent the same person, our method
is also the second best performing (average error of 1.99 cm) on FAUST-intra
challenge.
(a) SCAPE [4]
(b) TOSCA [12]
(c) TOSCA animals [12]
Fig. 4: Other datasets. Left images show the input, right images the recon-
struction with colors showing correspondences. Our method works with real
incomplete scans (a), strong synthetic perturbations (b), and on non-human
shapes (c).
Results on SCAPE : real and partial data. The SCAPE dataset pro-
vides meshes aligned to real scans and includes poses diﬀerent from our train-
ing dataset. When applying a network trained directly on our SMPL data, we
obtain satisfying performance, namely 3.14cm average Euclidean error. Quanti-
tative comparison of correspondence quality in terms of geodesic error are given
in Fig 5. We outperform all methods except for Deep Functional Maps [23].
SCAPE also allows evaluation on real partial scans. Quantitatively, the error on
these partial meshes is 4.04cm, similar to the performance on the full meshes.
Qualitative results are shown in Fig 4a.
Results on TOSCA : robustness to perturbations. The TOSCA dataset
provides several versions of the same synthetic mesh with diﬀerent perturbations.
We found that our method, still trained only on SMPL or SMAL data, is ro-
bust to all perturbations (isometry, noise, shotnoise, holes, micro-holes, topology
changes, and sampling), except scale, which can be trivially ﬁxed by normalizing
3D-CODED : 3D Correspondences by Deep Deformation
11
0
0.02
0.04
0.06
0.08
0.1
0
20
40
60
80
100
Geodesic error
% Correspondences
Ours
FMNet [23]
GCNN [27]
LSCNN [8]
ADD3 [9]
Fig. 5: Comparison with learning-based shape matching approaches on the
SCAPE dataset. Our method is trained on synthetic data, FMNet was trained
on FAUST data, and all other methods on SCAPE. We outperform all methods
except FMNet even though our method was trained on a diﬀerent dataset.
all meshes to have consistent surface area. Examples of representative qualitative
results are shown Fig 4b and quantitative results are reported in appendix [19].
Reconstruction optimization. Because the nearest neighbors used in the
matching step are sensitive to small errors in alignment, the second step of our
pipeline which ﬁnds the optimal features for reconstruction, is crucial to obtain
high quality results. This optimization however converges to a good optimum
only if it is initialized with a reasonable reconstruction, as visualized in Figure 6.
Since we optimize using Chamfer distance, and not correspondences, we also rely
on the fact that the network was trained to generate humans in correspondence
and we expect the optimized shape to still be meaningful.
Table 1 reports the associated quantitative results on FAUST-inter. We can
see that: (i) optimizing the latent feature to minimize the Chamfer distance
between input and output provides a strong boost; (ii) using a better (more
uniform) sampling of the shapes when training our network provided a bet-
ter initialization; (iii) using a high resolution sampling of the template (∼200k
Method
Faust error (cm)
Without regression
6.29
With regression
3.255
With regression + Regular Sampling
3.048
With regression + Regular Sampling + High-Res template
2.878
Table 1: Importance of the reconstruction optimization step. Optimizing
the latent feature is key to our results. Regular point sampling for training and
high resolution for the nearest neighbor step provide an additional boost.
12
T. Groueix, M. Fisher, V. G. Kim, B. C. Russell, M. Aubry
(a) Input
(b) Random init.
(c) Incorrect init.
(d) Valid init.
Fig. 6: Reconstruction optimization. The quality of the initialization (i.e.
the ﬁrst step of our algorithm) is crucial for the deformation optimization. For
a given target shape (a) and for diﬀerent initializations (left of (b), (c) and (d))
the ﬁgure shows the results of the optimization. If the initialization is random
(b) or incorrect (c), the optimization converges to bad local minima. With a
reasonable initialization (d) it converges to a shape very close to the target ((d),
right).
vertices) for the nearest-neighbor step provide an additional small boost in per-
formance.
Necessary amount of training data. Training on a large and representative
dataset is also crucial for our method. To analyze the eﬀect of training data,
we ran our method without re-sampling FAUST points regularly and with a low
resolution template for diﬀerent training sets: FAUST training set, 2×105 SUR-
REAL shapes, and 2.3 × 105, 104 and 103 shapes from our augmented dataset.
The quantitative results are reported Table 2 and qualitative results can be seen
in Figure 7. The FAUST training set only include 10 diﬀerent poses and is too
small to train our network to generalize. Training on many synthetic shapes from
the SURREAL dataset [42] helps overcome this generalization problem. How-
ever, if the synthetic dataset does not include any pose close to test poses (such
as bent-over humans), the method will fail on these poses (4 test pairs of shapes
out of 40). Augmenting the dataset as described in section 4.1 overcomes this
training data
Faust error (cm)
FAUST training set
18.22
non-augmented synthetic dataset 2 × 105 shapes
5.63
augmented synthetic data, 103 shapes
5.76
augmented synthetic data, 104 shapes
4.70
augmented synthetic data, 2.3 × 105 shapes
3.26
Table 2: FAUST-inter results when training on diﬀerent datasets.
Adding synthetic data reduce the error by a factor of 3, showing its impor-
tance. The diﬀerence in performance between the basic synthetic dataset and its
augmented version is mostly due to failure on speciﬁc poses, as in Figure 3 .
3D-CODED : 3D Correspondences by Deep Deformation
13
(a) Input
(b) FAUST training data
(c) Augm. synth. training data
Fig. 7: Importance of the training data. For a given target shape (a) re-
constructed shapes when the network is trained on FAUST training set (b) and
on our augmented synthetic training set (c), before (left) and after (right) the
optimization step.
limitation. As expected the performance decreases with the number of training
shapes, respectively to 5.76cm and 4.70cm average error on FAUST-inter.
Unsupervised correspondences. We investigate whether our method could
be trained without correspondence supervision. We started by simply using the
reconstruction loss described in Equation (3). One could indeed expect that an
optimal way to deform the template into training shapes would respect cor-
respondences. However, we found that the resulting network did not respect
correspondences between the template and the input shape, as visualized ﬁg-
ure 8. However, these results improve with adequate regularization such as the
one presented in Equarion (2), encouraging regularity of the mapping between
the template and the reconstruction. We trained such a network with the same
training data as in the supervised case but without any correspondence su-
pervision and obtained a 4.88cm of error on the FAUST-inter data, i.e. similar
to Deep Functional Map [23] which had an error of 4.83 cm. This demonstrates
that our method can be eﬃcient even without correspondence supervision. Fur-
ther details on regularization losses are given in the appendix [19].
Rotation invariance We handled rotation invariance by rotating the shape
and selecting the orientation for which the reconstruction is optimal. As an
alternative, we tried to learn a network directly invariant to rotations around
the vertical axis. It turned out the performances were slightly worse on FAUST-
Loss
Faust error (cm)
Chamfer distance, eq. 3 (unsupervised)
8.727
Chamfer distance + Regularization, eq. 2 (unsupervised)
4.835
Correspondences, eq. 1 (supervised)
2.878
Table 3: Results with and without supervised correspondences. Adding regular-
ization helps the network ﬁnd a better local minimum in terms of correspon-
dences.
14
T. Groueix, M. Fisher, V. G. Kim, B. C. Russell, M. Aubry
(a)
Input
(FAUST)
(b)
P.C.
after
optim.
(c)
Mesh
after
optim.
(d)
P.C.
after
optim + Regul
(e)
Mesh
after
optim + Regul
Fig. 8: Unsupervised correspondences. We visualize for diﬀerent inputs (a),
the point clouds (P.C.) predicted by our approach (b,d) and the corresponding
meshes (c,e). Note that without regularization, because of the strong distortion,
the meshes appear to barely match to the input, while the point clouds are
reasonable. On the other hand surface regularization creates reasonable meshes.
inter (3.10cm), but still better than the state of the art. We believe this is due to
the limited capacity of the network and should be tried with a larger network.
However, interestingly, this rotation invariant network seems to have increased
robustness and provided slightly better results on SCAPE.
5
Conclusion
We have demonstrated an encoder-decoder deep network architecture that can
generate human shape correspondences competitive with state-of-the-art ap-
proaches and that uses only simple reconstruction and correspondence losses.
Our key insight is to factor the problem into an encoder network that produces
a global shape descriptor, and a decoder Shape Deformation Network that uses
this global descriptor to map points on a template back to the original geome-
try. A straightforward regression step uses gradient descent through the Shape
Deformation Network to signiﬁcantly improve the ﬁnal correspondence quality.
Acknowledgments. This work was partly supported by ANR project EnHerit
ANR-17-CE23-0008, Labex B´ezout, and gifts from Adobe to ´Ecole des Ponts. We
thank G¨ul Varol, Angjoo Kanazawa, and Renaud Marlet for fruitful discussions.
3D-CODED : 3D Correspondences by Deep Deformation
15
References
1. Allen, B., Curless, B., Popovic, Z.: Articulated body deformation from range scan
data. SIGGRAPH (2002)
2. Allen, B., Curless, B., Popovic, Z.: The space of human body shapes: reconstruction
and parameterization from range scans. SIGGRAPH (2003)
3. Allen, B., Curless, B., Popovic, Z.: Learning a correlated model of identity and
pose-dependent body shape variation for real-time synthesis. Symposium on Com-
puter Animation (2006)
4. Anguelov, D., Srinivasan, P., Koller, D., Thrun, S., Rodgers, J., Davis, J.: Scape:
shape completion and animation of people. ACM transactions on graphics (TOG)
24(3), 408–416 (2005)
5. Aubry, M., Schlickewei, U., Cremers, D.: The wave kernel signature: A quan-
tum mechanical approach to shape analysis. IEEE International Conference on
Computer Vision (ICCV) - Workshop on Dynamic Shape Capture and Analysis
(4DMOD) (2011)
6. Bogo, F., Romero, J., Loper, M., Black, M.J.: FAUST: Dataset and evaluation for
3D mesh registration. Proceedings IEEE Conf. on Computer Vision and Pattern
Recognition (CVPR) (Jun 2014)
7. Boscaini, D., Masci, J., Rodola, E., Bronstein, M.M.: Learning shape correspon-
dence with anisotropic convolutional neural networks. NIPS (2016)
8. Boscaini, D., Masci, J., Melzi, S., Bronstein, M.M., Castellani, U., Vandergheynst,
P.: Learning class-speciﬁc descriptors for deformable shapes using localized spectral
convolutional networks. Computer Graphics Forum 34(5), 13–23 (2015)
9. Boscaini, D., Masci, J., Rodol`a, E., Bronstein, M.M., Cremers, D.: Anisotropic
diﬀusion descriptors. Computer Graphics Forum 35(2), 431–441 (2016)
10. Bronstein, A.M., Bronstein, M.M., Kimmel, R.: Eﬃcient computation of isometry-
invariant distances between surfaces. SIAM J. Scientiﬁc Computing (2006)
11. Bronstein, A.M., Bronstein, M.M., Kimmel, R.: Generalized multidimensional scal-
ing: a framework for isometry-invariant partial surface matching. Proc. National
Academy of Sciences (PNAS) (2006)
12. Bronstein, A.M., Bronstein, M.M., Kimmel, R.: Numerical geometry of non-rigid
shapes. Springer Science & Business Media (2008)
13. Chen, Q., Koltun, V.: Robust nonrigid registration by convex optimization. Inter-
national Conference on Computer Vision (ICCV) (2015)
14. D.Raviv, A.Dubrovina, R.Kimmel: Hierarchical framework for shape correspon-
dence. Numerical Mathematics: Theory, Methods and Applications (2013)
15. Ezuz, D., Solomon, J., Kim, V.G., Ben-Chen, M.: Gwcnn: A metric alignment layer
for deep shape analysis. SGP (2017)
16. Fan, H., Su, H., Guibas, L.: A point set generation network for 3D object re-
construction from a single image. Proceedings of IEEE Conference on Computer
Vision and Pattern Recognition (CVPR) (2017)
17. Girdhar, R., Fouhey, D., Rodriguez, M., Gupta, A.: Learning a predictable and
generative vector representation for objects. Proceedings of European Conference
on Computer Vision (ECCV) (2016)
18. Groueix, T., Fisher, M., Kim, V.G., Russell, B., Aubry, M.: AtlasNet: A Papier-
Mˆach´e Approach to Learning 3D Surface Generation. Proceedings IEEE Conf. on
Computer Vision and Pattern Recognition (CVPR) (2018)
19. Groueix, T., Fisher, M., Kim, V.G., Russell, B., Aubry, M.: Supplementary ma-
terial (appendix) for the paper https://http://imagine.enpc.fr/~groueixt/
3D-CODED/index.html (2018)
16
T. Groueix, M. Fisher, V. G. Kim, B. C. Russell, M. Aubry
20. Kim, V.G., Li, W., Mitra, N.J., DiVerdi, S., Funkhouser, T.: Exploring Collections
of 3D Models using Fuzzy Correspondences. Transactions on Graphics (Proc. of
SIGGRAPH) 31(4) (2012)
21. Kim, V.G., Lipman, Y., Funkhouser, T.: Blended Intrinsic Maps. Transactions on
Graphics (Proc. of SIGGRAPH) 30(4) (2011)
22. Lipman, Y., Funkhouser, T.: Mobius voting for surface correspondence. ACM
Transactions on Graphics (Proc. SIGGRAPH) 28(3) (2009)
23. Litany, O., Remez, T., Rodola, E., Bronstein, A.M., Bronstein, M.M.: Deep func-
tional maps: Structured prediction for dense shape correspondence. ICCV (2017)
24. Loper, M., Mahmood, N., Romero, J., Pons-Moll, G., Black, M.J.: Smpl: A skinned
multi-person linear model. SIGGRAPH Asia (2015)
25. Maron, H., Galun, M., Aigerman, N., Trope, M., Dym, N., Yumer, E., Kim, V.G.,
Lipman, Y.: Convolutional neural networks on surfaces via seamless toric covers.
SIGGRAPH (2017)
26. Masci, J., Boscaini, D., Bronstein, M.M., Vandergheynst, P.: Geodesic convolu-
tional neural networks on riemannian manifolds. Proc. of the IEEE International
Conference on Computer Vision (ICCV) Workshops pp. 37–45 (2015)
27. Masci, J., Boscaini, D., Bronstein, M.M., Vandergheynst, P.: Geodesic convolu-
tional neural networks on riemannian manifolds. 3dRR (2015)
28. M´emoli, F., Sapiro, S.: A theoretical and computational framework for isometry
invariant recognition of point cloud data. Foundations of Computational Mathe-
matics (2005)
29. Monti, F., Boscaini, D., Masci, J., Rodola, E., Svoboda, J., Bronstein, M.M.: Ge-
ometric deep learning on graphs and manifolds using mixture model cnns. CVPR
(2017)
30. Ovsjanikov, M., M´erigot, Q., M´emoli, F., Guibas, L.: One point isometric matching
with the heat kernel. Computer Graphics Forum (Proc. of SGP) (2010)
31. Ovsjanikov, M., Ben-Chen, M., Solomon, J., Butscher, A., Guibas, L.: Functional
maps: A ﬂexible representation of maps between shapes. ACM Trans. Graph.
(2012)
32. Qi, C.R., Su, H., Mo, K., Guibas, L.J.: PointNet: Deep learning on point sets for
3D classiﬁcation and segmentation. Proceedings of IEEE Conference on Computer
Vision and Pattern Recognition (CVPR) (2017)
33. Qi, C.R., Yi, L., Su, H., Guibas, L.J.: PointNet++: Deep hierarchical feature learn-
ing on point sets in a metric space. Advances in Neural Information Processing
Systems (NIPS) (2017)
34. Rodola, E., Rota Bulo, S., Windheuser, T., Vestner, M., Cremers, D.: Dense non-
rigid shape correspondence using random forests. CVPR (2014)
35. Sahillioglu, Y., Yemez, Y.: Coarse-to-ﬁne combinatorial matching for dense iso-
metric shape correspondence. Computer Graphics Forum (2011)
36. Sinha, A., Unmesh, A., Huang, Q., Ramani, K.: Surfnet: Generating 3d shape sur-
faces using deep residual networks. Proceedings of IEEE Conference on Computer
Vision and Pattern Recognition (CVPR) (2017)
37. Sinha, A., Bai, J., Ramani, K.: Deep learning 3d shape surfaces using geometry
images. Proceedings of IEEE Conference on Computer Vision and Pattern Recog-
nition (CVPR) (2016)
38. Solomon, J., Nguyen, A., Butscher, A., Ben-Chen, M., Guibas, L.: Soft maps be-
tween surfaces. SGP (2012)
39. Solomon, J., Peyre, G., Kim, V.G., Sra, S.: Entropic metric alignment for corre-
spondence problems. Transactions on Graphics (Proc. of SIGGRAPH) (2016)
3D-CODED : 3D Correspondences by Deep Deformation
17
40. Sun, J., Ovsjanikov, M., Guibas, L.: A concise and provably informative multi-
scale signature-based on heat diﬀusion”. Computer Graphics Forum (Proc. of SGP)
(2009)
41. Tombari, F., Salti, S., Stefano, L.D.: Unique signatures of histograms for local
surface description. ECCV (2010)
42. Varol, G., Romero, J., Martin, X., Mahmood, N., Black, M.J., Laptev, I., Schmid,
C.: Learning from synthetic humans. CVPR (2017)
43. Wei, L., Huang, Q., Ceylan, D., Vouga, E., Li, H.: Dense human body correspon-
dences using convolutional networks. Computer Vision and Pattern Recognition
(CVPR) (2016)
44. Wu, Z., Song, S., Khosla, A., Yu, F., Zhang, L., Tang, X., Xiao, J.: 3d shapenets:
A deep representation for volumetric shapes. Proceedings of the IEEE Conference
on Computer Vision and Pattern Recognition pp. 1912–1920 (2015)
45. Yang, Y., Feng, C., Shen, Y., Tian, D.: Foldingnet: Point cloud auto-encoder via
deep grid deformation. CVPR (2018)
46. Zuﬃ, S., Black., M.J.: The stitched puppet: A graphical model of 3d human shape
and pose. Proceedings IEEE Conf. on Computer Vision and Pattern Recognition
(CVPR) (2015)
47. Zuﬃ, S., Kanazawa, A., Black, M.J.: Lions and tigers and bears: Capturing non-
rigid, 3D, articulated shape from images. IEEE Conference on Computer Vision
and Pattern Recognition (CVPR) (2018)
48. Zuﬃ, S., Kanazawa, A., Jacobs, D., Black, M.J.: 3D menagerie: Modeling the 3D
shape and pose of animals. CVPR (2017)